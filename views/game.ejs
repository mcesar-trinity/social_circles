<%- include('./partials/header') %>

    <script>
        function getName(x){
            var names = new Array(characterGroups[x-1].length);
            for(var y = 0; y < characterGroups[x-1].length; y++) { 
                names[y] = characterGroups[x-1][y].names;
            }

            return names;
        }
        
        function submit(){
            console.log("Submmited")
            document.getElementById("gameForm").submit;
        }

        function selectedButton(id){
            const element = id;
            const buttonGroup = document.getElementsByClassName("group");
            
            console.log(element);

            for(let i = 0; i < buttonGroup.length; i++ ) {
                console.log(buttonGroup[i].id);
                if(buttonGroup[i].id == element){
                    buttonGroup[i].style.backgroundColor = "gold";
                    document.getElementsByName('selected-group').value=getCharacter(buttonGroup[i]);
                    console.log(document.getElementsByName('selected-group').value);
                }else{
                    buttonGroup[i].style.backgroundColor = "#38b6ff";
                }
            }
        }

        function getSelectedButton(){
            const buttonGroup = document.getElementsByClassName("group");
            var submit = false;

            for(let i = 0; i < buttonGroup.length; i++) {
                if(buttonGroup[i].style.backgroundColor === "gold"){
                    document.gameForm.selectedGroup.value = getCharacter(buttonGroup[i]);
                    sumbit = true;
                    break;
                }
            }

            return submit;
        }


        function getCharacter(button){
            const element = button.getElementsByClassName("name");
            var text = "";

            for(let i = 0; i < element.length; i++){
                text += element[i].innerText;
            }

            console.log(text);

            return text;
        }

        function hover(id){
            const element = id;
            const buttonGroup = document.getElementsByClassName("group");
            
            console.log(element);

            for(let i = 0; i < buttonGroup.length; i++ ) {
                console.log(buttonGroup[i].id);
                if(buttonGroup[i].id == element){
                    if(buttonGroup[i].style.backgroundColor != "gold"){
                        buttonGroup[i].style.backgroundColor = "greenyellow";
                    }
                }else{
                    if(buttonGroup[i].style.backgroundColor != "gold"){
                        buttonGroup[i].style.backgroundColor = "#38b6ff";
                    }
                }
            }
        }

    </script>

    <body class="home">
        <form name="gameForm" action="/game" method="post" id="gameForm" onsubmit="getSelectedButton()">
            <div class="tasks-game">
                <select name="task" id="task-options">
                    <% tasks.forEach((task) => { %>
                        <option value=" <%=task%> "><%=task%></option>
                    <% }) %> 
                </select>
            </div>

            <div class="info-section"> 
                <div class="character-groups">
                    <% for(var x = 1; x < 4; x++) { %>
                        <button type="button" id="<%=x%> name="group-<%=x%>" value="getName(<%=x%>);" class="group" onmouseover="hover(this.id);" onclick="selectedButton(this.id)">
                            <h2>Group #<%=x%>:</h2>

                            <% for(var y = 0; y < characterGroups[0].length; y++) { %>
                                <div class="character">
                                    <h3 class="name"><%=characterGroups[x-1][y].name%></h3>
                                    <h3 class="score">H: <%=characterGroups[x-1][y].happiness_score%></h3>
                                    <h3 class="score">D: <%=characterGroups[x-1][y].durability_score%></h3>
                                </div>
                            <% } %>
                        </button>
                    <% } %> 

                    <input type="hidden" name="selectedGroup" id="selected-group">
                </div>
                <div class="leaderboard-player">
                    <div class="player-happiness">
                        <h2>Player Happiness: <%=userData[0].happiness_score%></h2>
                    </div>

                    <div class="leaderboard-section">
                        <div class="info"> 
                            <h2>Top 5 Player</h2>
                            <h3>Placeholder</h3>
                        </div>

                        <div class="game-to-leaderboard">
                                <button type="submit" id="leaderboard" name="option" value="Leaderboard" onclick="window.location=`/leaderboard`; return false;">Leaderboard</button>
                        </div>
                    </div>
                </div>
            </div>
        

            <div class="assign-task">
                <button class="submit" type="submit" id="assign-task-button" value="Assign Tasks">Assign Task</button>
            </div>

        </form>
    </body>

</html>